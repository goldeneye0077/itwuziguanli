{
  "name": "it-asset-lifecycle",
  "version": "0.1.0",
  "private": true,
  "packageManager": "bun@1.3.3",
  "scripts": {
    "lint": "bun run lint:backend && bun run lint:frontend",
    "lint:backend": "python -m pip install --disable-pip-version-check -r backend/requirements-dev.txt && python -m ruff check backend/app",
    "lint:frontend": "bun run --cwd frontend typecheck",
    "typecheck": "bun run typecheck:backend && bun run typecheck:frontend",
    "typecheck:backend": "python -m compileall -q backend/app",
    "typecheck:frontend": "bun run --cwd frontend typecheck",
    "test": "bun run test:backend && bun run test:frontend",
    "test:backend": "python -m pip install --disable-pip-version-check -r backend/requirements-dev.txt && python -c \"import subprocess,sys; result=subprocess.run([sys.executable,'-m','pytest','-q','backend']); sys.exit(0 if result.returncode in (0,5) else result.returncode)\"",
    "test:frontend": "bun run --cwd frontend test",
    "build": "bun run build:backend && bun run build:frontend",
    "build:backend": "python -m compileall -q backend/app",
    "build:frontend": "bun run --cwd frontend build",
    "smoke": "python -c \"import os,socket,subprocess,sys,time,urllib.request;\ndef free_port():\n    sock=socket.socket(); sock.bind(('127.0.0.1',0)); port=sock.getsockname()[1]; sock.close(); return port\nenv=os.environ.copy(); env.update({'MYSQL_PORT':str(free_port()),'REDIS_PORT':str(free_port()),'MINIO_API_PORT':str(free_port()),'MINIO_CONSOLE_PORT':str(free_port()),'BACKEND_PORT':str(free_port()),'FRONTEND_PORT':str(free_port()),'NGINX_PORT':str(free_port())}); backend_port=env['BACKEND_PORT']; compose=['docker','compose','-p','ci-smoke','-f','deploy/docker-compose.yml']; subprocess.run(compose+['down','--remove-orphans','-v'],check=False,env=env); subprocess.run(compose+['config'],check=True,env=env)\ntry:\n    subprocess.run(compose+['up','-d','--build','backend'],check=True,env=env)\n    url=f'http://127.0.0.1:{backend_port}/healthz'; last_error=''\n    for _ in range(90):\n        try:\n            body=urllib.request.urlopen(url, timeout=2).read().decode('utf-8').lower()\n            if 'ok' in body:\n                sys.exit(0)\n            last_error=body\n        except Exception as exc:\n            last_error=str(exc)\n        time.sleep(1)\n    print(f'Smoke failed: {last_error}')\n    sys.exit(1)\nfinally:\n    subprocess.run(compose+['down','--remove-orphans','-v'],check=False,env=env)\""
  }
}
